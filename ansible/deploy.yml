- name: Jenkins + Ansible SSH & File Transfer Demo
  hosts: docker
  become: yes

  tasks:
    - name: Check SSH connectivity
      ping:

    - name: Ensure target directory exists
      file:
        path: /opt/demo
        state: directory
        mode: '0755'

    - name: Copy file to target machine
      copy:
        src: files/app.conf        # 相对 ansible/ 目录
        dest: /tmp/app.conf
        owner: deploy
        group: deploy
        mode: '0644'

    - name: Verify file content
      shell: cat /tmp/app.conf
      register: result

    - name: Show file content in Jenkins log
      debug:
        msg: "{{ result.stdout }}"
